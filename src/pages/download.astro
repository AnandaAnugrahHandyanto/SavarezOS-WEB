---
import MainLayout from "../layouts/MainLayout.astro";
---

<MainLayout>
  <section class="relative min-h-screen pt-44 pb-32 flex flex-col items-center bg-[#020203] overflow-hidden">
    <div class="absolute inset-0">
      <div class="portal-orbit w-[600px] h-[600px]"></div>
      <div class="portal-orbit w-[1000px] h-[1000px]" style="animation-delay: -5s;"></div>
    </div>

    <div class="relative z-10 w-full max-w-5xl px-10 reveal">
      <div class="text-center mb-24">
        <h1 class="text-7xl font-black text-white uppercase tracking-tighter italic mb-4">The Forge<span class="text-blue-600">.</span></h1>
        <p class="text-gray-500 uppercase tracking-[0.3em] text-[10px] font-bold">Secure the latest system build</p>
      </div>

      <div class="liquid-card grid md:grid-cols-2 gap-16 items-center">
        <div>
          <div class="inline-block px-4 py-1 rounded-full bg-blue-500/10 border border-blue-500/20 text-[9px] font-black text-blue-400 uppercase tracking-[0.3em] mb-6">
            // Official Latest Build
          </div>
          <h2 class="text-4xl font-bold text-white mb-8 tracking-tighter italic uppercase">SavarezOS <span id="iso-version" class="text-blue-600">--</span></h2>
          
          <div class="space-y-6 mb-12">
            <div class="flex justify-between items-center border-b border-white/5 pb-4">
              <span class="text-[10px] font-bold uppercase tracking-widest text-gray-500">Architecture</span>
              <span class="text-white text-xs font-mono">x86_64</span>
            </div>
            <div class="flex justify-between items-center border-b border-white/5 pb-4">
              <span class="text-[10px] font-bold uppercase tracking-widest text-gray-500">File Size</span>
              <span id="iso-size" class="text-white text-xs font-mono">--</span>
            </div>
            <div class="flex justify-between items-center border-b border-white/5 pb-4">
              <span class="text-[10px] font-bold uppercase tracking-widest text-gray-500">Published Date</span>
              <span id="iso-date" class="text-white text-xs font-mono">--</span>
            </div>
          </div>

          <a id="iso-download" href="#" class="inline-block w-full bg-white text-black py-5 rounded-2xl font-black text-center uppercase text-[11px] tracking-[0.4em] hover:bg-blue-600 hover:text-white transition-all duration-700">
            Download Latest ISO
          </a>
        </div>

        <div class="hidden md:block">
          <div class="p-10 liquid-panel rounded-[2.5rem] border-white/5">
            <h4 class="text-white text-[10px] font-black uppercase tracking-widest mb-8 italic text-blue-500">// Build Status</h4>
            <div class="flex items-center space-x-4 mb-6">
              <div class="w-3 h-3 rounded-full bg-green-500 animate-pulse"></div>
              <span class="text-white text-xs font-bold uppercase tracking-widest">Verified Stable</span>
            </div>
            <p class="text-gray-500 text-[11px] leading-relaxed font-light mb-8">
              This build has passed all AOSP and kernel stability tests on standard development hardware.
            </p>
            <div class="bg-black/40 p-4 rounded-xl border border-white/5">
              <p class="text-[9px] font-bold text-gray-600 uppercase mb-2">SHA256 Checksum</p>
              <code class="text-[9px] text-blue-400 break-all font-mono">verification_pending...</code>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script is:inline>
    async function loadRelease() {
      try {
        const res = await fetch(`https://api.github.com/repos/AnandaAnugrahHandyanto/SavarezOS_Debian-Based/releases/latest`);
        const data = await res.json();
        const iso = data.assets.find(f => f.name && f.name.endsWith(".iso"));
        
        document.getElementById("iso-version").innerText = data.tag_name || "--";
        document.getElementById("iso-date").innerText = new Date(data.published_at).toLocaleDateString("en-US", {
          year: 'numeric', month: 'short', day: 'numeric'
        });
        
        if (iso) {
          document.getElementById("iso-size").innerText = (iso.size / 1024 / 1024 / 1024).toFixed(2) + " GB";
          document.getElementById("iso-download").href = iso.browser_download_url;
        }
      } catch (e) { console.error("Forge Error:", e); }
    }
    loadRelease();

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) entry.target.classList.add("show");
      });
    }, { threshold: 0.1 });
    document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
  </script>
</MainLayout>
